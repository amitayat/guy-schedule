<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="manifest" href="manifest.json">
<title>××¢×¨×›×ª ×©×¢×•×ª - ×’×™× ğŸ€</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;600;700;900&display=swap');
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --maccabi-yellow: #FFD700;
  --maccabi-blue: #003DA5;
  --maccabi-dark: #00275e;
  --maccabi-light: #FFF8DC;
}

body {
  font-family: 'Heebo', -apple-system, sans-serif;
  background: var(--maccabi-blue);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 0;
  overflow-x: hidden;
}

/* Hero banner */
.hero {
  width: 100%;
  background: linear-gradient(135deg, var(--maccabi-dark) 0%, var(--maccabi-blue) 50%, #004cc4 100%);
  padding: 24px 20px 20px;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.hero::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image: url(maccabi-logo.svg);
  background-size: 160px;
  background-position: center center;
  background-repeat: no-repeat;
  opacity: 0.15;
}
.hero[data-player] { position: relative; }
.hero::after {
  content: 'â­';
  position: absolute;
  font-size: 80px;
  opacity: 0.07;
  bottom: -10px;
  right: -10px;
}
.hero-logo { font-size: 2.8rem; margin-bottom: 4px; }
.hero-greeting { color: var(--maccabi-yellow); font-size: 1.4rem; font-weight: 700; }
.hero-day { color: var(--maccabi-yellow); font-size: 1.6rem; font-weight: 900; margin-top: 6px; text-shadow: 0 2px 8px rgba(0,0,0,0.4); }
.hero-date { color: #fff; font-size: 1.1rem; font-weight: 600; margin-top: 6px; }

/* Player of the day */
.player-card {
  background: linear-gradient(135deg, var(--maccabi-yellow), #FFC000);
  margin: 0 16px 24px;
  border-radius: 16px;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  position: relative;
  z-index: 2;
}
.player-img { width: 56px; height: 56px; border-radius: 50%; overflow: hidden; border: 3px solid var(--maccabi-dark); flex-shrink: 0; }
.player-img img { width: 100%; height: 100%; object-fit: cover; }
.player-info { flex: 1; }
.player-name { font-weight: 900; font-size: 1rem; color: var(--maccabi-dark); }
.player-quote { font-size: 0.8rem; color: var(--maccabi-blue); font-weight: 600; margin-top: 2px; }
.player-number { font-size: 2rem; font-weight: 900; color: var(--maccabi-dark); opacity: 0.3; }

/* Next game */
.next-game {
  background: var(--maccabi-dark);
  margin: -8px 16px 12px;
  border-radius: 14px;
  padding: 14px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  border: 1px solid rgba(255,215,0,0.2);
}
.next-game-icon { font-size: 1.6rem; }
.next-game-info { flex: 1; }
.next-game-label { color: var(--maccabi-yellow); font-size: 0.75rem; font-weight: 700; letter-spacing: 1px; }
.next-game-detail { color: #fff; font-size: 0.9rem; font-weight: 600; margin-top: 2px; }
.next-game-countdown { color: var(--maccabi-yellow); font-size: 0.8rem; margin-top: 2px; }

/* Schedule card */
.schedule-card {
  background: var(--maccabi-dark);
  margin: 0 16px 16px;
  border-radius: 20px;
  padding: 20px 16px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.2);
  position: relative;
  overflow: hidden;
}
.schedule-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center top;
  background-repeat: no-repeat;
  background-image: var(--player-bg);
  opacity: 0.12;
  pointer-events: none;
}
.schedule-title {
  font-weight: 700;
  font-size: 1rem;
  color: var(--maccabi-yellow);
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
  position: relative;
}

.lesson {
  display: flex;
  align-items: center;
  padding: 11px 14px;
  border-radius: 12px;
  margin-bottom: 6px;
}
.lesson-num {
  width: 30px; height: 30px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-weight: 800; font-size: 0.8rem; color: #fff;
  margin-left: 12px; flex-shrink: 0;
}
.lesson-info { flex: 1; }
.lesson { position: relative; }
.lesson-subject { font-weight: 700; font-size: 0.95rem; color: #fff; }
.lesson-time { font-size: 0.78rem; color: rgba(255,255,255,0.6); margin-top: 1px; }

/* Maccabi-themed lesson colors - alternating yellow/blue glass */
.lesson[data-i="0"] { background: rgba(255,215,0,0.2); } .lesson[data-i="0"] .lesson-num { background: var(--maccabi-yellow); color: var(--maccabi-dark); }
.lesson[data-i="1"] { background: rgba(0,61,165,0.35); } .lesson[data-i="1"] .lesson-num { background: #4a90d9; }
.lesson[data-i="2"] { background: rgba(255,215,0,0.2); } .lesson[data-i="2"] .lesson-num { background: var(--maccabi-yellow); color: var(--maccabi-dark); }
.lesson[data-i="3"] { background: rgba(0,61,165,0.35); } .lesson[data-i="3"] .lesson-num { background: #4a90d9; }
.lesson[data-i="4"] { background: rgba(255,215,0,0.2); } .lesson[data-i="4"] .lesson-num { background: var(--maccabi-yellow); color: var(--maccabi-dark); }
.lesson[data-i="5"] { background: rgba(0,61,165,0.35); } .lesson[data-i="5"] .lesson-num { background: #4a90d9; }

/* Equipment */
.equipment-section {
  margin-top: 16px;
  padding: 14px;
  background: rgba(255,215,0,0.15);
  border-radius: 14px;
  border: 2px solid rgba(255,215,0,0.3);
  position: relative;
}
.equipment-title { font-weight: 800; font-size: 0.95rem; color: var(--maccabi-yellow); margin-bottom: 8px; }
.equipment-item { padding: 3px 0; font-size: 0.85rem; color: rgba(255,255,255,0.85); }



/* No school */
.no-school { text-align: center; padding: 60px 20px; }
.no-school-emoji { font-size: 4rem; margin-bottom: 16px; }
.no-school-text { font-size: 1.5rem; font-weight: 800; color: var(--maccabi-yellow); }
.no-school-sub { font-size: 1rem; color: rgba(255,255,255,0.7); margin-top: 8px; }

/* Notes FAB */
.notes-fab {
  position: fixed; top: 16px; right: 16px; z-index: 100;
  width: 44px; height: 44px; border-radius: 50%;
  background: linear-gradient(135deg, var(--maccabi-yellow), #FFC000);
  border: none; box-shadow: 0 4px 16px rgba(0,0,0,0.4);
  font-size: 1.3rem; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: transform 0.2s;
}
.notes-fab:active { transform: scale(0.9); }

/* Notes modal overlay */
.notes-overlay {
  position: fixed; inset: 0; z-index: 200;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
  display: flex; align-items: center; justify-content: center;
  padding: 20px;
  opacity: 0; pointer-events: none; transition: opacity 0.25s;
}
.notes-overlay.open { opacity: 1; pointer-events: auto; }
.notes-modal {
  background: var(--maccabi-dark); border-radius: 20px;
  width: 100%; max-width: 360px; padding: 24px 20px 24px;
  transform: scale(0.9); opacity: 0; transition: transform 0.25s ease-out, opacity 0.25s;
  max-height: 80vh; overflow-y: auto;
  border: 1px solid rgba(255,215,0,0.15);
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}
.notes-overlay.open .notes-modal { transform: scale(1); opacity: 1; }
.notes-modal-handle { width: 40px; height: 4px; background: rgba(255,255,255,0.15); border-radius: 2px; margin: 0 auto 18px; }
.notes-modal-title { color: var(--maccabi-yellow); font-size: 1.1rem; font-weight: 800; margin-bottom: 18px; text-align: center; }

.notes-form-group { margin-bottom: 14px; }
.notes-label { color: rgba(255,255,255,0.6); font-size: 0.8rem; font-weight: 600; margin-bottom: 6px; display: block; }
.notes-input, .notes-textarea {
  width: 100%; border: 2px solid rgba(255,215,0,0.15); border-radius: 12px;
  background: rgba(255,255,255,0.06); color: #fff; font-family: 'Heebo', sans-serif;
  font-size: 0.95rem; padding: 11px 14px; outline: none; transition: border-color 0.2s;
  -webkit-appearance: none;
}
.notes-input[type="date"] { color-scheme: dark; }
.notes-input:focus, .notes-textarea:focus { border-color: var(--maccabi-yellow); }
.notes-textarea { min-height: 72px; resize: none; }
.notes-btn {
  width: 100%; padding: 13px; border: none; border-radius: 12px; cursor: pointer;
  font-family: 'Heebo', sans-serif; font-weight: 800; font-size: 1rem;
  background: linear-gradient(135deg, var(--maccabi-yellow), #FFC000);
  color: var(--maccabi-dark); margin-top: 6px; transition: opacity 0.2s;
}
.notes-btn:active { opacity: 0.8; }

/* Saved notes list in modal */
.notes-list { margin-top: 18px; border-top: 1px solid rgba(255,255,255,0.08); padding-top: 14px; }
.notes-list-title { color: rgba(255,255,255,0.4); font-size: 0.75rem; font-weight: 700; letter-spacing: 1px; margin-bottom: 10px; }
.note-item {
  display: flex; align-items: center; gap: 10px;
  background: rgba(255,255,255,0.05); border-radius: 10px;
  padding: 10px 12px; margin-bottom: 6px;
}
.note-item-date { color: var(--maccabi-yellow); font-size: 0.75rem; font-weight: 700; white-space: nowrap; min-width: 50px; }
.note-item-text { flex: 1; color: rgba(255,255,255,0.85); font-size: 0.85rem; line-height: 1.3; }
.note-item-del {
  background: none; border: none; color: rgba(255,100,100,0.6); font-size: 1rem; cursor: pointer;
  padding: 6px; border-radius: 8px; transition: background 0.2s;
}
.note-item-del:active { background: rgba(255,100,100,0.15); }

/* Close button in modal */
.notes-close {
  position: absolute; top: 14px; left: 14px;
  background: rgba(255,255,255,0.1); border: none; color: rgba(255,255,255,0.5);
  width: 30px; height: 30px; border-radius: 50%; font-size: 1rem;
  cursor: pointer; display: flex; align-items: center; justify-content: center;
  transition: background 0.2s;
}
.notes-close:active { background: rgba(255,255,255,0.2); }

/* Homework FAB */
.hw-fab {
  position: fixed; top: 16px; left: 16px; z-index: 100;
  width: 44px; height: 44px; border-radius: 50%;
  background: linear-gradient(135deg, #4a90d9, var(--maccabi-blue));
  border: none; box-shadow: 0 4px 16px rgba(0,0,0,0.4);
  font-size: 1.3rem; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: transform 0.2s; color: #fff;
}
.hw-fab:active { transform: scale(0.9); }
.hw-badge {
  position: absolute; top: -4px; right: -4px;
  background: #ff4444; color: #fff; font-size: 0.65rem; font-weight: 800;
  min-width: 18px; height: 18px; border-radius: 9px;
  display: flex; align-items: center; justify-content: center;
  padding: 0 4px;
}

/* Homework overlay */
.hw-overlay {
  position: fixed; inset: 0; z-index: 200;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
  display: flex; align-items: center; justify-content: center;
  padding: 20px;
  opacity: 0; pointer-events: none; transition: opacity 0.25s;
}
.hw-overlay.open { opacity: 1; pointer-events: auto; }
.hw-modal {
  background: var(--maccabi-dark); border-radius: 20px;
  width: 100%; max-width: 380px; padding: 24px 20px 24px;
  transform: scale(0.9); opacity: 0; transition: transform 0.25s ease-out, opacity 0.25s;
  max-height: 85vh; overflow-y: auto;
  border: 1px solid rgba(74,144,217,0.2);
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
  position: relative;
}
.hw-overlay.open .hw-modal { transform: scale(1); opacity: 1; }
.hw-modal-title { color: #4a90d9; font-size: 1.1rem; font-weight: 800; margin-bottom: 16px; text-align: center; }
.hw-empty { text-align: center; color: rgba(255,255,255,0.4); padding: 30px 0; font-size: 0.95rem; }

.hw-item {
  display: flex; align-items: flex-start; gap: 10px;
  background: rgba(255,255,255,0.05); border-radius: 12px;
  padding: 12px; margin-bottom: 8px;
  border-right: 3px solid rgba(74,144,217,0.5);
  transition: opacity 0.3s;
}
.hw-item.completing { opacity: 0; transform: translateX(-20px); }
.hw-check {
  width: 24px; height: 24px; border-radius: 6px;
  border: 2px solid rgba(74,144,217,0.4); background: none;
  cursor: pointer; flex-shrink: 0; margin-top: 2px;
  display: flex; align-items: center; justify-content: center;
  color: transparent; font-size: 0.8rem; transition: all 0.2s;
}
.hw-check:active { background: rgba(74,144,217,0.3); color: #fff; }
.hw-item-body { flex: 1; }
.hw-item-subject { font-weight: 700; font-size: 0.8rem; color: #4a90d9; }
.hw-item-text { color: rgba(255,255,255,0.85); font-size: 0.88rem; margin-top: 2px; line-height: 1.4; }
.hw-item-date { color: rgba(255,255,255,0.3); font-size: 0.72rem; margin-top: 4px; }

/* Today's notes reminder */
.notes-reminder {
  margin-top: 16px; padding: 14px;
  background: rgba(255,100,50,0.2); border-radius: 14px;
  border: 2px solid rgba(255,100,50,0.4); position: relative;
}
.notes-reminder-title { font-weight: 800; font-size: 0.95rem; color: #ff9944; margin-bottom: 8px; }
.notes-reminder-item { padding: 3px 0; font-size: 0.85rem; color: rgba(255,255,255,0.9); }
</style>
</head>
<body>
<div id="app"></div>
<script>
const schedule = {
  0: { name: '×™×•× ×¨××©×•×Ÿ', emoji: 'ğŸ”µ', lessons: [
    { time: '08:00', subject: '×©×¤×”', equipment: null },
    { time: '08:45', subject: '×©×¤×”', equipment: null },
    { time: '09:30', subject: '×©×‘×™×œ×™ ×™×©×¨××œ', equipment: 'ğŸ““ ××—×‘×¨×ª ×©×‘×™×œ×™ ×™×©×¨××œ' },
    { time: '10:30', subject: '××ª××˜×™×§×”', equipment: null },
    { time: '11:15', subject: '××“×¢×™×', equipment: 'ğŸ““ ××—×‘×¨×ª ××“×¢×™× + ğŸ“– ×—×•×‘×¨×ª ××“×¢×™×' },
    { time: '12:00', subject: '××“×¢×™×', equipment: 'ğŸ““ ××—×‘×¨×ª ××“×¢×™× + ğŸ“– ×—×•×‘×¨×ª ××“×¢×™×' },
  ]},
  1: { name: '×™×•× ×©× ×™', emoji: 'ğŸŸ¢', lessons: [
    { time: '08:00', subject: '×—× "×’', equipment: 'ğŸ’§ ××™×' },
    { time: '08:45', subject: '×× ×’×œ×™×ª', equipment: 'ğŸ“– 2 ×—×•×‘×¨×•×ª ×× ×’×œ×™×ª + ğŸ““ ××—×‘×¨×ª ×× ×’×œ×™×ª' },
    { time: '09:30', subject: '×× ×’×œ×™×ª', equipment: 'ğŸ“– 2 ×—×•×‘×¨×•×ª ×× ×’×œ×™×ª + ğŸ““ ××—×‘×¨×ª ×× ×’×œ×™×ª' },
    { time: '10:30', subject: '××ª××˜×™×§×”', equipment: null },
    { time: '11:15', subject: '×©×¤×”', equipment: null },
    { time: '12:00', subject: '×©×¤×”', equipment: null },
  ]},
  2: { name: '×™×•× ×©×œ×™×©×™', emoji: 'ğŸŸ¡', lessons: [
    { time: '08:00', subject: '×ª×™××˜×¨×•×Ÿ', equipment: null },
    { time: '08:45', subject: '×ª×™××˜×¨×•×Ÿ', equipment: null },
    { time: '09:30', subject: '××•×¨×©×ª ×™×©×¨××œ', equipment: 'ğŸ““ ××—×‘×¨×ª ×•×¨×•×“×” (××•×¨×©×ª) + ğŸ“– ×—×•×‘×¨×ª ××•×¨×©×ª ×™×©×¨××œ' },
    { time: '10:30', subject: '××ª××˜×™×§×”', equipment: null },
    { time: '11:15', subject: '××•×¨×©×ª ×™×©×¨××œ', equipment: 'ğŸ““ ××—×‘×¨×ª ×•×¨×•×“×” (××•×¨×©×ª) + ğŸ“– ×—×•×‘×¨×ª ××•×¨×©×ª ×™×©×¨××œ' },
    { time: '12:00', subject: '×©×¤×”', equipment: null },
  ]},
  3: { name: '×™×•× ×¨×‘×™×¢×™', emoji: 'ğŸŸ ', lessons: [
    { time: '08:00', subject: '××ª××˜×™×§×”', equipment: null },
    { time: '08:45', subject: '××ª××˜×™×§×”', equipment: null },
    { time: '09:30', subject: '×× ×’×œ×™×ª', equipment: 'ğŸ“– 2 ×—×•×‘×¨×•×ª ×× ×’×œ×™×ª + ğŸ““ ××—×‘×¨×ª ×× ×’×œ×™×ª' },
    { time: '10:30', subject: '×× ×’×œ×™×ª', equipment: 'ğŸ“– 2 ×—×•×‘×¨×•×ª ×× ×’×œ×™×ª + ğŸ““ ××—×‘×¨×ª ×× ×’×œ×™×ª' },
    { time: '11:15', subject: '×ª× "×š', equipment: 'ğŸ““ ××—×‘×¨×ª ×ª× "×š + ğŸ“• ×¡×¤×¨ ×ª× "×š' },
  ]},
  4: { name: '×™×•× ×—××™×©×™', emoji: 'ğŸ”´', lessons: [
    { time: '08:00', subject: '×›×™×©×•×¨×™ ×—×™×™×', equipment: null },
    { time: '08:45', subject: '×—× "×’', equipment: 'ğŸ’§ ××™×' },
    { time: '09:30', subject: '×’××•××˜×¨×™×”', equipment: 'ğŸ“– ×—×•×‘×¨×ª ××‘×™×–×¨×™× (×’××•××˜×¨×™×”) + ğŸ“– ×—×•×‘×¨×ª ×’××•××˜×¨×™×” + ğŸ““ ××—×‘×¨×ª ×’××•××˜×¨×™×”' },
    { time: '10:30', subject: '×”×™×¡×˜×•×¨×™×”', equipment: 'ğŸ““ ××—×‘×¨×ª ×”×™×¡×˜×•×¨×™×” + ğŸ“– ×—×•×‘×¨×ª ×”×™×¡×˜×•×¨×™×”' },
    { time: '11:15', subject: '×ª× "×š', equipment: 'ğŸ““ ××—×‘×¨×ª ×ª× "×š + ğŸ“• ×¡×¤×¨ ×ª× "×š' },
    { time: '12:00', subject: '××“×¢×™×', equipment: 'ğŸ““ ××—×‘×¨×ª ××“×¢×™× + ğŸ“– ×—×•×‘×¨×ª ××“×¢×™×' },
  ]},
  5: { name: '×™×•× ×©×™×©×™', emoji: 'ğŸŸ£', lessons: [
    { time: '08:00', subject: '×”×¢×©×¨×”', equipment: null },
    { time: '08:45', subject: '×× ×’×œ×™×ª', equipment: 'ğŸ“– 2 ×—×•×‘×¨×•×ª ×× ×’×œ×™×ª + ğŸ““ ××—×‘×¨×ª ×× ×’×œ×™×ª' },
    { time: '09:30', subject: '×©×¤×”', equipment: null },
    { time: '10:30', subject: '××¤×ª×— ×”×œ×‘', equipment: null },
  ]},
};

const holidays = {"holidays":[{"date":"2026-03-03","name":"×¤×•×¨×™×"},{"date":"2026-03-04","name":"×©×•×©×Ÿ ×¤×•×¨×™×"},{"date":"2026-04-02","name":"×¤×¡×—"},{"date":"2026-04-03","name":"×¤×¡×—"},{"date":"2026-04-04","name":"×—×•×œ ×”××•×¢×“ ×¤×¡×—"},{"date":"2026-04-05","name":"×—×•×œ ×”××•×¢×“ ×¤×¡×—"},{"date":"2026-04-06","name":"×—×•×œ ×”××•×¢×“ ×¤×¡×—"},{"date":"2026-04-07","name":"×—×•×œ ×”××•×¢×“ ×¤×¡×—"},{"date":"2026-04-08","name":"×©×‘×™×¢×™ ×©×œ ×¤×¡×—"},{"date":"2026-04-22","name":"×™×•× ×”×–×™×›×¨×•×Ÿ"},{"date":"2026-04-23","name":"×™×•× ×”×¢×¦×××•×ª"},{"date":"2026-05-22","name":"×©×‘×•×¢×•×ª"},{"date":"2026-09-22","name":"×¨××© ×”×©× ×”"},{"date":"2026-09-23","name":"×¨××© ×”×©× ×”"},{"date":"2026-10-01","name":"×™×•× ×›×™×¤×•×¨"},{"date":"2026-10-06","name":"×¡×•×›×•×ª"},{"date":"2026-10-07","name":"×—×•×œ ×”××•×¢×“ ×¡×•×›×•×ª"},{"date":"2026-10-08","name":"×—×•×œ ×”××•×¢×“ ×¡×•×›×•×ª"},{"date":"2026-10-09","name":"×—×•×œ ×”××•×¢×“ ×¡×•×›×•×ª"},{"date":"2026-10-10","name":"×—×•×œ ×”××•×¢×“ ×¡×•×›×•×ª"},{"date":"2026-10-12","name":"×©××—×ª ×ª×•×¨×”"},{"date":"2026-10-13","name":"×©××—×ª ×ª×•×¨×”"}],"vacations":[{"from":"2026-04-02","to":"2026-04-09","name":"×—×•×¤×©×ª ×¤×¡×—"},{"from":"2026-07-01","to":"2026-08-31","name":"×—×•×¤×©×ª ×§×™×¥"},{"from":"2026-10-06","to":"2026-10-13","name":"×—×•×¤×©×ª ×¡×•×›×•×ª"}]};

// Maccabi players - different one each day
const players = [
  { name: '×’×³×•×Ÿ ×“×™×‘×¨×ª×•×œ×•××™××•', number: '#12', img: 'players/sun-dibartolomeo.jpg', quote: '×”×§×¤×˜×Ÿ ××•××¨: ×ª×Ÿ ×”×›×œ ×”×™×•×!' },
  { name: '×’×³×™×™×œ×Ÿ ×”×•×¨×“', number: '#1', img: 'players/mon-hoard.jpg', quote: '××”×™×¨×•×ª ×‘×›×œ ×“×‘×¨ - ×’× ×‘×œ×™××•×“×™×!' },
  { name: '×œ×•× ×™ ×•×•×§×¨', number: '#8', img: 'players/tue-walker.jpg', quote: '××™×Ÿ ×¢×¦×™×¨×•×ª - ×§×“×™××” ×œ×¢×•×“ ×™×•×!' },
  { name: '×ª××™×¨ ×‘×œ××˜', number: '#45', img: 'players/wed-blatt.jpg', quote: '×™×œ×“ ×©×œ ××××Ÿ ××•××¨: ×ª×›× ×•×Ÿ = × ×™×¦×—×•×Ÿ!' },
  { name: '××•×©×™×™ ×‘×¨×™×¡×˜', number: '#10', img: 'players/thu-brissett.jpg', quote: '×ª×”×¨×•×¡ ××ª ×”×™×•× ×›××• ×¡×œ ×©×œ×•×©!' },
  { name: '×˜×™.×’×³×™×™ ×œ×™×£', number: '#22', img: 'players/fri-leaf.jpg', quote: '×”×’× ×” ×—×–×§×” ×’× ×‘×‘×™×ª ×¡×¤×¨!' },
];

const greetings = ['×‘×•×§×¨ ×˜×•×‘ ×’×™×! â˜€ï¸','×™××œ×œ×” ×¦×”×•×‘, ×‘×•×§×¨ ×˜×•×‘! ğŸ’›','×‘×•×§×¨ ××•×¨! ğŸ€','×§×•× ×§×•×, Game Day! âš¡','×‘×•×§×¨ ×˜×•×‘ ××œ×•×£! ğŸ†','×™×•× ××¢×•×œ×” ××ª×—×™×œ! ğŸ’›ğŸ’™'];


// Next games (update periodically)
const nextGames = [
  // Home games
  { date: '2026-03-05', time: '21:05', opponent: '×”×¤×•×¢×œ ×ª"×', comp: '×œ×™×’×ª ×”×¢×œ', home: true },
  { date: '2026-03-08', time: '20:55', opponent: '×”×¤×•×¢×œ ×’×œ×™×œ ×¢×œ×™×•×Ÿ', comp: '×™×•×¨×•×œ×™×’', home: true },
  // Away
  { date: '2026-03-13', time: '21:30', opponent: '××™×œ×× ×•', comp: '×™×•×¨×•×œ×™×’', home: false },
  { date: '2026-03-15', time: '20:00', opponent: '×”×¤×•×¢×œ ×”×¢××§', comp: '×œ×™×’×ª ×”×¢×œ', home: false },
  // Away
  { date: '2026-03-20', time: '21:00', opponent: '×•×™×œ×¨×‘××Ÿ', comp: '×™×•×¨×•×œ×™×’', home: false },
  // Home
  { date: '2026-03-22', time: '20:00', opponent: '×¢×™×¨×•× ×™ ×§×¨×™×ª ××ª×', comp: '×œ×™×’×ª ×”×¢×œ', home: true },
  { date: '2026-03-24', time: '21:05', opponent: '×¤× ×¨×‘×—×¦×”', comp: '×™×•×¨×•×œ×™×’', home: true },
  { date: '2026-03-26', time: '21:05', opponent: '×“×•×‘××™', comp: '×™×•×¨×•×œ×™×’', home: true },
  { date: '2026-03-29', time: '20:00', opponent: '×”×¤×•×¢×œ ×ª×œ ××‘×™×‘', comp: '×œ×™×’×ª ×”×¢×œ', home: true },
  { date: '2026-04-01', time: '21:05', opponent: '×× ××“×•×œ×• ××¤×¡', comp: '×™×•×¨×•×œ×™×’', home: true },
  // Away
  { date: '2026-04-03', time: '20:00', opponent: '××›×‘×™ ×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ', comp: '×œ×™×’×ª ×”×¢×œ', home: false },
  { date: '2026-04-07', time: '21:30', opponent: '×‘××¡×§×•× ×™×” ×•×™×˜×•×¨×™×”', comp: '×™×•×¨×•×œ×™×’', home: false },
  { date: '2026-04-09', time: '21:45', opponent: '×¤×¨×™×–', comp: '×™×•×¨×•×œ×™×’', home: false },
  { date: '2026-04-12', time: '20:00', opponent: '×”×¤×•×¢×œ ×™×¨×•×©×œ×™×', comp: '×œ×™×’×ª ×”×¢×œ', home: false },
  // Home
  { date: '2026-04-16', time: '21:05', opponent: '×•×™×¨×˜×•×¡ ×‘×•×œ×•× ×™×”', comp: '×™×•×¨×•×œ×™×’', home: true },
  { date: '2026-04-19', time: '20:00', opponent: '××œ×™×¦×•×¨ × ×ª× ×™×”', comp: '×œ×™×’×ª ×”×¢×œ', home: true },
  { date: '2026-04-23', time: '20:00', opponent: '×”×¤×•×¢×œ ×‘"×©', comp: '×œ×™×’×ª ×”×¢×œ', home: true },
  { date: '2026-04-28', time: '20:00', opponent: '×‘× ×™ ×”×¨×¦×œ×™×”', comp: '×œ×™×’×ª ×”×¢×œ', home: true },
];

function getNextGame() {
  const today = new Date().toISOString().slice(0, 10);
  return nextGames.find(g => g.date >= today);
}

function daysUntil(dateStr) {
  const target = new Date(dateStr + 'T00:00:00');
  const now = new Date();
  now.setHours(0,0,0,0);
  const diff = Math.ceil((target - now) / (1000*60*60*24));
  if (diff === 0) return '×”×™×•×! ğŸ”¥ğŸ”¥ğŸ”¥';
  if (diff === 1) return '××—×¨! ğŸ”¥';
  return `×¢×•×“ ${diff} ×™××™×`;
}

function render() {
  const app = document.getElementById('app');
  const now = new Date();
  const dayIndex = now.getDay();
  const today = now.toISOString().slice(0, 10);
  const dateStr = now.toLocaleDateString('he-IL', { day: 'numeric', month: 'long', year: 'numeric' });

  // Saturday
  if (dayIndex === 6) {
    app.innerHTML = `
      <div class="hero" style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center">
        <div class="no-school">
          <div class="no-school-emoji">ğŸ€</div>
          <div class="no-school-text">×©×‘×ª ×©×œ×•×!</div>
          <div class="no-school-sub">××™×Ÿ ×œ×™××•×“×™× - ×™×•× ×©×œ ×× ×•×—×” ×•×›×“×•×¨×¡×œ ğŸ’›ğŸ’™</div>
        </div>
      </div>`;
    return;
  }

  // Holiday
  const holiday = holidays.holidays.find(h => h.date === today);
  if (holiday) {
    app.innerHTML = `
      <div class="hero" style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center">
        <div class="no-school">
          <div class="no-school-emoji">ğŸ–ï¸</div>
          <div class="no-school-text">${holiday.name}</div>
          <div class="no-school-sub">××™×Ÿ ×œ×™××•×“×™× ×”×™×•×! ğŸ‰</div>
        </div>
      </div>`;
    return;
  }
  const vacation = holidays.vacations.find(v => today >= v.from && today <= v.to);
  if (vacation) {
    app.innerHTML = `
      <div class="hero" style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center">
        <div class="no-school">
          <div class="no-school-emoji">ğŸ–ï¸</div>
          <div class="no-school-text">${vacation.name}</div>
          <div class="no-school-sub">××™×Ÿ ×œ×™××•×“×™×! ğŸ‰</div>
        </div>
      </div>`;
    return;
  }

  const day = schedule[dayIndex];
  const seed = now.getFullYear() * 1000 + now.getMonth() * 31 + now.getDate();
  const greeting = greetings[seed % greetings.length];
  const player = players[dayIndex % players.length];

  const equipmentSet = new Set();
  day.lessons.forEach(l => { if (l.equipment) equipmentSet.add(l.equipment); });

  const lessonsHTML = day.lessons.map((l, i) => `
    <div class="lesson" data-i="${i}">
      <div class="lesson-num">${i + 1}</div>
      <div class="lesson-info">
        <div class="lesson-subject">${l.subject}</div>
        <div class="lesson-time">${l.time}</div>
      </div>
    </div>
  `).join('');

  let equipHTML = '';
  if (equipmentSet.size > 0) {
    equipHTML = `<div class="equipment-section">
      <div class="equipment-title">ğŸ’ ××” ×œ×§×—×ª ×”×™×•×:</div>
      ${[...equipmentSet].map(e => `<div class="equipment-item">âœ… ${e}</div>`).join('')}
    </div>`;
  }

  // Next game
  const nextGame = getNextGame();
  let gameHTML = '';
  if (nextGame) {
    gameHTML = `
    <div class="next-game">
      <div class="next-game-icon">ğŸ€</div>
      <div class="next-game-info">
        <div class="next-game-label">×”××©×—×§ ×”×‘×</div>
        <div class="next-game-detail">${nextGame.home ? 'ğŸ ' : 'âœˆï¸'} ××›×‘×™ ×ª"× vs ${nextGame.opponent}</div>
        <div class="next-game-countdown">${nextGame.comp} | ${nextGame.time} | ${daysUntil(nextGame.date)}</div>
      </div>
    </div>`;
  }

  app.innerHTML = `
    <div class="hero" id="hero">
      <div class="hero-logo">ğŸ’›ğŸ€ğŸ’™</div>
      <div class="hero-greeting">${greeting}</div>
      <div class="hero-day">${day.emoji} ${day.name}</div>
      <div class="hero-date">${dateStr}</div>
    </div>

    ${gameHTML}

    <div class="schedule-card" style="--player-bg: url(${player.img})">
      <div class="schedule-title">ğŸ“‹ ××¢×¨×›×ª ×”×©×¢×•×ª</div>
      ${lessonsHTML}
      ${equipHTML}
    </div>

    <div class="player-card">
      <div class="player-img"><img src="${player.img}" alt="${player.name}"></div>
      <div class="player-info">
        <div class="player-name">${player.name}</div>
        <div class="player-quote">"${player.quote}"</div>
      </div>
      <div class="player-number">${player.number}</div>
    </div>
  `;
}

render();

// ===== Notes System =====
const NOTES_KEY = 'guy-schedule-notes';

function getNotes() {
  try { return JSON.parse(localStorage.getItem(NOTES_KEY) || '[]'); }
  catch { return []; }
}
function saveNotes(notes) { localStorage.setItem(NOTES_KEY, JSON.stringify(notes)); }
function getNotesForDate(dateStr) { return getNotes().filter(n => n.date === dateStr); }

function formatDateHe(dateStr) {
  const d = new Date(dateStr + 'T00:00:00');
  return d.toLocaleDateString('he-IL', { day: 'numeric', month: 'short' });
}

// Inject FAB + overlay into DOM
function initNotesUI() {
  // FAB button
  const fab = document.createElement('button');
  fab.className = 'notes-fab';
  fab.innerHTML = 'ğŸ“';
  fab.title = '×”×•×¡×£ ×”×¢×¨×”';
  fab.onclick = () => openNotesModal();
  document.body.appendChild(fab);

  // Overlay
  const overlay = document.createElement('div');
  overlay.className = 'notes-overlay';
  overlay.id = 'notes-overlay';
  overlay.onclick = (e) => { if (e.target === overlay) closeNotesModal(); };
  document.body.appendChild(overlay);
}

function openNotesModal() {
  const overlay = document.getElementById('notes-overlay');
  const today = new Date().toISOString().slice(0, 10);
  const notes = getNotes().filter(n => n.date >= today).sort((a,b) => a.date.localeCompare(b.date));

  let listHTML = '';
  if (notes.length > 0) {
    listHTML = `<div class="notes-list">
      <div class="notes-list-title">ğŸ“Œ ×”×¢×¨×•×ª ×§×¨×•×‘×•×ª</div>
      ${notes.map((n, i) => `
        <div class="note-item">
          <div class="note-item-date">${formatDateHe(n.date)}</div>
          <div class="note-item-text">${n.text}</div>
          <button class="note-item-del" onclick="deleteNote(${i}, '${today}')">âœ•</button>
        </div>
      `).join('')}
    </div>`;
  }

  overlay.innerHTML = `
    <div class="notes-modal" style="position:relative">
      <button class="notes-close" onclick="closeNotesModal()">âœ•</button>
      <div class="notes-modal-handle"></div>
      <div class="notes-modal-title">ğŸ“ ×”×•×¡×£ ×”×¢×¨×” ×œ×™×•×</div>
      <div class="notes-form-group">
        <label class="notes-label">ğŸ“… ×‘×—×¨ ×ª××¨×™×š</label>
        <input type="date" class="notes-input" id="note-date" value="${today}" min="${today}">
      </div>
      <div class="notes-form-group">
        <label class="notes-label">âœï¸ ××” ×œ×–×›×•×¨?</label>
        <textarea class="notes-textarea" id="note-text" placeholder="×œ××©×œ: ×œ×‘×•× ×¢× ×—×•×œ×¦×” ×œ×‘× ×”" dir="rtl"></textarea>
      </div>
      <button class="notes-btn" onclick="saveNote()">ğŸ’¾ ×©××•×¨</button>
      ${listHTML}
    </div>
  `;
  overlay.classList.add('open');
}

function closeNotesModal() {
  document.getElementById('notes-overlay').classList.remove('open');
}

function saveNote() {
  const dateEl = document.getElementById('note-date');
  const textEl = document.getElementById('note-text');
  const date = dateEl.value;
  const text = textEl.value.trim();
  if (!text) { textEl.focus(); return; }

  const notes = getNotes();
  notes.push({ date, text, created: Date.now() });
  saveNotes(notes);

  closeNotesModal();
  render(); // re-render to show today's notes if applicable
}

window.deleteNote = function(filteredIdx, today) {
  const allNotes = getNotes();
  const futureNotes = allNotes.filter(n => n.date >= today).sort((a,b) => a.date.localeCompare(b.date));
  const toDelete = futureNotes[filteredIdx];
  if (!toDelete) return;

  const actualIdx = allNotes.findIndex(n => n.date === toDelete.date && n.text === toDelete.text && n.created === toDelete.created);
  if (actualIdx !== -1) {
    allNotes.splice(actualIdx, 1);
    saveNotes(allNotes);
  }
  openNotesModal(); // refresh modal
  render();
};

// Patch render to include today's notes
const _origRender = render;
// We need to inject notes into the schedule card. Override via MutationObserver approach:
function injectTodayNotes() {
  const today = new Date().toISOString().slice(0, 10);
  const todayNotes = getNotesForDate(today);
  if (todayNotes.length === 0) return;

  const scheduleCard = document.querySelector('.schedule-card');
  if (!scheduleCard) return;

  // Check if already injected
  if (scheduleCard.querySelector('.notes-reminder')) return;

  const reminderDiv = document.createElement('div');
  reminderDiv.className = 'notes-reminder';
  reminderDiv.innerHTML = `
    <div class="notes-reminder-title">âš¡ ×ª×–×›×•×¨×•×ª ×œ×”×™×•×:</div>
    ${todayNotes.map(n => `<div class="notes-reminder-item">ğŸ“Œ ${n.text}</div>`).join('')}
  `;

  // Insert before equipment or at end
  const equip = scheduleCard.querySelector('.equipment-section');
  if (equip) scheduleCard.insertBefore(reminderDiv, equip);
  else scheduleCard.appendChild(reminderDiv);
}

// Re-wrap render
const origRenderFn = render;
window.render = function() { origRenderFn(); injectTodayNotes(); };
// Also clean up old notes (past dates)
function cleanOldNotes() {
  const today = new Date().toISOString().slice(0, 10);
  const notes = getNotes().filter(n => n.date >= today);
  saveNotes(notes);
}
cleanOldNotes();

initNotesUI();
injectTodayNotes();

// ===== Homework System =====
const HW_DONE_KEY = 'guy-hw-done';
const HW_CACHE_KEY = 'guy-hw-cache';
const HW_URL = 'homework.json';
const HW_SYNC_URL = 'https://jsonblob.com/api/jsonBlob/019c9f1b-7438-707f-92cd-691242ab02c5';

function hwKey(item) { return item.date + '|' + item.subject + '|' + item.homework; }

// Sync done state: read from cloud, merge with local
async function getHwDone() {
  let local = [];
  try { local = JSON.parse(localStorage.getItem(HW_DONE_KEY) || '[]'); } catch {}
  try {
    const res = await fetch(HW_SYNC_URL, { headers: { 'Accept': 'application/json' } });
    if (res.ok) {
      const cloud = await res.json();
      // Merge: union of local + cloud
      const merged = [...new Set([...local, ...cloud])];
      localStorage.setItem(HW_DONE_KEY, JSON.stringify(merged));
      // Push merged back if different
      if (merged.length !== cloud.length) syncHwDone(merged);
      return new Set(merged);
    }
  } catch {}
  return new Set(local);
}

function syncHwDone(arr) {
  fetch(HW_SYNC_URL, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
    body: JSON.stringify(arr)
  }).catch(() => {});
}

function markHwDone(key) {
  let local = [];
  try { local = JSON.parse(localStorage.getItem(HW_DONE_KEY) || '[]'); } catch {}
  if (!local.includes(key)) local.push(key);
  localStorage.setItem(HW_DONE_KEY, JSON.stringify(local));
  syncHwDone(local);
}

async function fetchHomework() {
  try {
    const res = await fetch(HW_URL + '?t=' + Date.now());
    if (!res.ok) return [];
    const data = await res.json();
    localStorage.setItem(HW_CACHE_KEY, JSON.stringify(data));
    return data;
  } catch {
    try { return JSON.parse(localStorage.getItem(HW_CACHE_KEY) || '[]'); }
    catch { return []; }
  }
}

async function getUndoneHomework(allHw) {
  const done = await getHwDone();
  return allHw.filter(item => !done.has(hwKey(item)));
}

function initHomeworkUI() {
  // FAB
  const fab = document.createElement('button');
  fab.className = 'hw-fab';
  fab.id = 'hw-fab';
  fab.innerHTML = 'ğŸ“š';
  fab.title = '×©×™×¢×•×¨×™ ×‘×™×ª';
  fab.onclick = () => openHomeworkModal();
  document.body.appendChild(fab);

  // Overlay
  const overlay = document.createElement('div');
  overlay.className = 'hw-overlay';
  overlay.id = 'hw-overlay';
  overlay.onclick = (e) => { if (e.target === overlay) closeHomeworkModal(); };
  document.body.appendChild(overlay);

  // Load and show badge
  updateHwBadge();
}

async function updateHwBadge() {
  const allHw = await fetchHomework();
  const undone = await getUndoneHomework(allHw);
  const fab = document.getElementById('hw-fab');
  const existing = fab.querySelector('.hw-badge');
  if (existing) existing.remove();
  if (undone.length > 0) {
    const badge = document.createElement('span');
    badge.className = 'hw-badge';
    badge.textContent = undone.length;
    fab.appendChild(badge);
  }
}

async function openHomeworkModal() {
  const overlay = document.getElementById('hw-overlay');
  const allHw = await fetchHomework();
  const undone = await getUndoneHomework(allHw);

  // Sort by date ascending (oldest first - do those first!)
  undone.sort((a, b) => a.date.localeCompare(b.date));

  let listHTML = '';
  if (undone.length === 0) {
    listHTML = '<div class="hw-empty">ğŸ‰ ××™×Ÿ ×©×™×¢×•×¨×™ ×‘×™×ª! ×”×›×œ × ×¢×©×”</div>';
  } else {
    listHTML = undone.map((item, i) => {
      const dateFormatted = new Date(item.date + 'T00:00:00').toLocaleDateString('he-IL', { day: 'numeric', month: 'short', year: 'numeric', weekday: 'short' });
      return `
        <div class="hw-item" id="hw-item-${i}">
          <button class="hw-check" onclick="completeHomework(${i})" title="×¡×™×™××ª×™!">âœ“</button>
          <div class="hw-item-body">
            <div class="hw-item-subject">${item.subject}</div>
            <div class="hw-item-text">${item.homework}</div>
            <div class="hw-item-date">${dateFormatted}</div>
          </div>
        </div>
      `;
    }).join('');
  }

  overlay.innerHTML = `
    <div class="hw-modal">
      <button class="notes-close" onclick="closeHomeworkModal()">âœ•</button>
      <div class="notes-modal-handle"></div>
      <div class="hw-modal-title">ğŸ“š ×©×™×¢×•×¨×™ ×‘×™×ª (${undone.length})</div>
      <div id="hw-list">${listHTML}</div>
    </div>
  `;
  overlay.classList.add('open');

  // Store current undone list for reference
  window._hwUndone = undone;
}

function closeHomeworkModal() {
  document.getElementById('hw-overlay').classList.remove('open');
}

window.completeHomework = function(idx) {
  const item = window._hwUndone?.[idx];
  if (!item) return;

  // Animate out
  const el = document.getElementById('hw-item-' + idx);
  if (el) {
    el.style.transition = 'opacity 0.3s, transform 0.3s';
    el.style.opacity = '0';
    el.style.transform = 'translateX(-20px)';
  }

  // Mark done (syncs to cloud)
  markHwDone(hwKey(item));

  // Refresh after animation
  setTimeout(() => {
    openHomeworkModal();
    updateHwBadge();
  }, 350);
};

initHomeworkUI();
</script>
</body>
</html>
